# Mermaid ç»˜å›¾é¿å‘æŒ‡å— (Mermaid Best Practices & Troubleshooting)

æœ¬æ–‡æ¡£è®°å½•äº†åœ¨ç¼–å†™ `light_social_design.html` æ—¶é‡åˆ°çš„ Mermaid æ¸²æŸ“é”™è¯¯åŠå…¶è§£å†³æ–¹æ¡ˆï¼Œä¾›åç»­ç»˜å›¾å‚è€ƒã€‚

## ğŸš« å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ

### 1. èŠ‚ç‚¹æ–‡æœ¬åŒ…å«ç‰¹æ®Šå­—ç¬¦ (Special Characters in Node Labels)

Mermaid è§£æå™¨ææ˜“è¢«èŠ‚ç‚¹æ–‡æœ¬ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ç©ºæ ¼ã€å†’å·ã€æ‹¬å·ã€åŠ å·ç­‰ï¼‰æ··æ·†ï¼Œå¯¼è‡´ `Syntax error`ã€‚

*   **é”™è¯¯ç¤ºä¾‹ (Wrong):**
    ```mermaid
    graph LR
    A[äººæ•° < 10] --> B[æ˜¾ç¤ºé‚»çº¿è™šå½±]
    C[çŠ¶æ€:æ¿’æ­»] --> D[è™šå½±å˜çº¢ + å¤´é¡¶SOS]
    ```

*   **æ­£ç¡®ç¤ºä¾‹ (Correct):** **åŠ¡å¿…ä½¿ç”¨åŒå¼•å·åŒ…è£¹æ–‡æœ¬**
    ```mermaid
    graph LR
    A["äººæ•° < 10"] --> B["æ˜¾ç¤ºé‚»çº¿è™šå½±"]
    C["çŠ¶æ€:æ¿’æ­»"] --> D["è™šå½±å˜çº¢ + å¤´é¡¶SOS"]
    ```

### 2. å­å›¾æ ‡é¢˜åŒ…å«æ‹¬å· (Subgraph Titles with Brackets)

`subgraph` çš„æ ‡é¢˜å¦‚æœåŒ…å«æ‹¬å· `()` ä¸”æœªåŠ å¼•å·ï¼Œä¼šå¯¼è‡´æ•´ä¸ªå›¾è¡¨æ— æ³•æ¸²æŸ“ã€‚

*   **é”™è¯¯ç¤ºä¾‹ (Wrong):**
    ```mermaid
    subgraph M [4. è¿ç§» (ç›¸ä½è·ƒè¿)]
        ...
    end
    ```

*   **æ­£ç¡®ç¤ºä¾‹ (Correct):**
    ```mermaid
    subgraph M ["4. è¿ç§» (ç›¸ä½è·ƒè¿)"]
        ...
    end
    ```

### 3. è¿çº¿ä¸Šçš„æ–‡å­—åŒ…å«ç‰¹æ®Šå­—ç¬¦ (Edge Labels)

è¿çº¿ä¸Šçš„æ–‡å­—ï¼ˆLabelï¼‰å¦‚æœåŒ…å«æ‹¬å·æˆ–å…¶ä»–ç‰¹æ®Šç¬¦å·ï¼Œå¿…é¡»åŠ å¼•å·ã€‚

*   **é”™è¯¯ç¤ºä¾‹ (Wrong):**
    ```mermaid
    A -->|å‘å‡ºé‚€è¯· (åæ ‡é”šç‚¹)| B
    C -->|Yes| D
    ```

*   **æ­£ç¡®ç¤ºä¾‹ (Correct):**
    ```mermaid
    A -->|"å‘å‡ºé‚€è¯· (åæ ‡é”šç‚¹)"| B
    C -->|"Yes"| D
    ```

### 4. æ–‡æœ¬ä¸­åŒ…å«ç®­å¤´ç¬¦å· (Arrows in Text)

å¦‚æœåœ¨æ–‡æœ¬ä¸­ä½¿ç”¨ `->`ï¼ŒMermaid å¯èƒ½ä¼šå°†å…¶è¯¯åˆ¤ä¸ºæµç¨‹å›¾çš„è¿æ¥ç¬¦ã€‚

*   **é”™è¯¯ç¤ºä¾‹ (Wrong):**
    ```mermaid
    A["A -> B æ•°æ®ä¼ è¾“"]
    ```

*   **æ­£ç¡®ç¤ºä¾‹ (Correct):** ä½¿ç”¨ç‰¹æ®Šç¬¦å· `â†’` æˆ– HTML å®ä½“
    ```mermaid
    A["A â†’ B æ•°æ®ä¼ è¾“"]
    ```

## âœ… æœ€ä½³å®è·µ (Best Practices)

1.  **é˜²å¾¡æ€§ç¼–ç¨‹**: å…»æˆç»™æ‰€æœ‰æ˜¾ç¤ºæ–‡æœ¬ï¼ˆNode Label, Edge Label, Subgraph Titleï¼‰**é»˜è®¤åŠ ä¸ŠåŒå¼•å·**çš„ä¹ æƒ¯ï¼Œæ— è®ºå†…å®¹æ˜¯å¦ç®€å•ã€‚
    *   `A["Simple"]` ä¼˜äº `A[Simple]`
2.  **é¢œè‰²æ ·å¼ç®¡ç†**: ä½¿ç”¨ `classDef` ç»Ÿä¸€ç®¡ç†é¢œè‰²ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šç¡¬ç¼–ç æ ·å¼ã€‚
    ```mermaid
    classDef action fill:#fff3e0,stroke:#f39c12;
    A["Action"]:::action
    ```
3.  **æ–¹å‘æ§åˆ¶**: åœ¨ `subgraph` å†…éƒ¨æ˜¾å¼å£°æ˜æ–¹å‘ï¼ˆå¦‚ `direction TB`ï¼‰ï¼Œé˜²æ­¢å¸ƒå±€æ··ä¹±ã€‚

## ğŸ“ å¸¸ç”¨é¢œè‰²å®šä¹‰ (Color Palette)

æœ¬é¡¹ç›®ç»Ÿä¸€ä½¿ç”¨çš„é¢œè‰²æ–¹æ¡ˆï¼š

```mermaid
classDef perception fill:#e8f4fd,stroke:#3498db,stroke-width:2px; /* è“è‰²: æ„ŸçŸ¥ */
classDef ice fill:#fff3e0,stroke:#f39c12,stroke-width:2px;        /* æ©™è‰²: ç ´å†°/è¡ŒåŠ¨ */
classDef interaction fill:#f3e5f5,stroke:#9b59b6,stroke-width:2px; /* ç´«è‰²: äº¤äº’ */
classDef migration fill:#e8f5e9,stroke:#27ae60,stroke-width:2px;   /* ç»¿è‰²: è¿ç§»/ç»“æœ */
classDef danger fill:#fdedec,stroke:#c0392b,stroke-width:2px;      /* çº¢è‰²: å±é™©/è­¦å‘Š */
```
