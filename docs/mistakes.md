# 错题本 (Mistakes Log)

记录开发过程中遇到的问题、原因分析及解决方案。

## Mermaid 制图与 HTML 渲染问题

### 1. HTML 结构导致 Mermaid 渲染失败
**问题描述**：
在 HTML 文件中嵌入 Mermaid 代码时，浏览器报错 `Syntax error`，提示无法解析文本。
**原因分析**：
Mermaid 代码块所在的 `div` 容器缺少闭合标签 `</div>`。导致浏览器继续向下解析，将后续的 HTML 标签（如 `<h4>`）误认为是 Mermaid 代码的一部分。
**解决方案**：
仔细检查 HTML 结构，确保所有 `div` 标签正确闭合。
```html
<!-- 错误示例 -->
<div class="mermaid">
graph LR
A --> B
<!-- 缺少 </div> -->
<h4>Next Section</h4>

<!-- 正确示例 -->
<div class="mermaid">
graph LR
A --> B
</div> <!-- 必须闭合 -->
<h4>Next Section</h4>
```

### 2. 复杂嵌套布局导致渲染崩溃 (图裂)
**问题描述**：
Mermaid 流程图无法显示，直接裂开或空白。
**原因分析**：
使用了过深的嵌套结构，且方向交替过于频繁。例如：`Line 1 (TB)` 内部嵌套 `Scene (LR)`，外部容器又是 `LR`。这种三层混合布局（LR -> TB -> LR）容易导致渲染引擎计算坐标失败。
**解决方案**：
*   **简化嵌套**：尽量减少 `subgraph` 的层级。
*   **拆分系统**：将复杂的单一大图拆分为多个独立的并列系统（如 System 1, System 2）。
*   **统一方向**：尽量保持主方向一致，或仅做简单的垂直堆叠。

### 3. 大图排版与浏览体验冲突
**问题描述**：
*   图表太宽，用户需要左右滑动，体验不佳。
*   图表太小，文字看不清。
**尝试过程**：
1.  **方案一 (失败)**：设置 `min-width: 1600px` 并开启 `overflow-x: scroll`。用户反馈不喜欢滑动。
2.  **方案二 (失败)**：使用 `transform: scale(1.3)` 放大。虽然字大了，但图表可能会溢出容器。
3.  **方案三 (成功)**：
    *   **宏观布局纵向化**：将 System/Line 等大容器设置为 `TB` (Top-Bottom) 排列。
    *   **微观流程横向化**：将具体的时间轴/步骤设置为 `LR` (Left-Right) 排列。
    *   **自适应宽度**：CSS 设置 `width: 100%; height: auto;`。
**结论**：
对于复杂流程图，最佳实践是 **"流程横向走，模块纵向排"**，这样既符合阅读习惯，又适配屏幕宽度。

### 4. Mermaid 语法细节
*   **特殊字符**：节点文本中包含 `>`、`<` 等字符时，必须用双引号包裹文本，例如 `A["1. A 濒死"]`。
*   **连线重复**：避免重复定义相同的连线（如 `A-->B` 写了两次），这会导致渲染多条线，影响美观。

